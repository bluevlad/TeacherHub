# 4. API 명세 (API Specification)

## 4.1 API 개요

### Base URL

| 환경 | URL |
|------|-----|
| 개발 (Windows) | `http://localhost:8081` |
| 운영 (MacBook) | `http://localhost:9010` |

### 공통 응답 형식

```json
{
    "data": { ... },
    "message": "success",
    "timestamp": "2026-02-04T14:00:00"
}
```

### 에러 응답

```json
{
    "error": "BAD_REQUEST",
    "message": "Invalid date format",
    "timestamp": "2026-02-04T14:00:00"
}
```

---

## 4.2 Report API (v2)

### 일별 리포트 조회

특정 날짜의 강사별 통계를 조회합니다.

```
GET /api/v2/reports/daily
```

#### Parameters

| 파라미터 | 타입 | 필수 | 설명 | 예시 |
|----------|------|------|------|------|
| date | String | O | 조회 날짜 (YYYY-MM-DD) | 2026-02-04 |

#### Request

```bash
curl -X GET "http://localhost:8081/api/v2/reports/daily?date=2026-02-04"
```

#### Response

```json
{
    "periodType": "daily",
    "startDate": "2026-02-04",
    "endDate": "2026-02-04",
    "periodLabel": "2월 4일 (수)",
    "year": 2026,
    "month": 2,
    "week": null,
    "totalTeachers": 12,
    "totalMentions": 134,
    "totalPositive": 55,
    "totalNegative": 30,
    "totalNeutral": 49,
    "avgSentimentScore": 0.25,
    "positiveRatio": 41.04,
    "teacherSummaries": [
        {
            "teacherId": 1,
            "teacherName": "홍길동",
            "academyName": "에듀윌",
            "subjectName": "국어",
            "mentionCount": 15,
            "positiveCount": 8,
            "negativeCount": 3,
            "neutralCount": 4,
            "recommendationCount": 5,
            "avgSentimentScore": 0.45,
            "reportDays": 1
        }
    ]
}
```

---

### 주별 리포트 조회

특정 주차의 집계 통계를 조회합니다. (ISO 8601 기준, 월요일 시작)

```
GET /api/v2/reports/weekly
```

#### Parameters

| 파라미터 | 타입 | 필수 | 설명 | 예시 |
|----------|------|------|------|------|
| year | Integer | O | 연도 | 2026 |
| week | Integer | O | 주차 (1-53) | 5 |

#### Request

```bash
curl -X GET "http://localhost:8081/api/v2/reports/weekly?year=2026&week=5"
```

#### Response

```json
{
    "periodType": "weekly",
    "startDate": "2026-01-26",
    "endDate": "2026-02-01",
    "periodLabel": "2026년 1월 5주차",
    "year": 2026,
    "month": 1,
    "week": 5,
    "totalTeachers": 25,
    "totalMentions": 456,
    "totalPositive": 180,
    "totalNegative": 120,
    "totalNeutral": 156,
    "avgSentimentScore": 0.18,
    "positiveRatio": 39.47,
    "teacherSummaries": [ ... ]
}
```

---

### 월별 리포트 조회

특정 월의 집계 통계를 조회합니다.

```
GET /api/v2/reports/monthly
```

#### Parameters

| 파라미터 | 타입 | 필수 | 설명 | 예시 |
|----------|------|------|------|------|
| year | Integer | O | 연도 | 2026 |
| month | Integer | O | 월 (1-12) | 1 |

#### Request

```bash
curl -X GET "http://localhost:8081/api/v2/reports/monthly?year=2026&month=1"
```

#### Response

```json
{
    "periodType": "monthly",
    "startDate": "2026-01-01",
    "endDate": "2026-01-31",
    "periodLabel": "2026년 1월",
    "year": 2026,
    "month": 1,
    "week": null,
    "totalTeachers": 45,
    "totalMentions": 1520,
    "totalPositive": 650,
    "totalNegative": 380,
    "totalNeutral": 490,
    "avgSentimentScore": 0.22,
    "positiveRatio": 42.76,
    "teacherSummaries": [ ... ]
}
```

---

### 선택 가능 기간 목록 조회

기간 선택 드롭다운에 표시할 옵션 목록을 조회합니다.

```
GET /api/v2/reports/periods
```

#### Request

```bash
curl -X GET "http://localhost:8081/api/v2/reports/periods"
```

#### Response

```json
{
    "daily": [
        { "date": "2026-02-04", "label": "2월 4일 (수)" },
        { "date": "2026-02-03", "label": "2월 3일 (화)" },
        { "date": "2026-02-02", "label": "2월 2일 (월)" }
    ],
    "weekly": [
        { "year": 2026, "week": 6, "label": "2026년 2월 1주차" },
        { "year": 2026, "week": 5, "label": "2026년 1월 5주차" },
        { "year": 2026, "week": 4, "label": "2026년 1월 4주차" }
    ],
    "monthly": [
        { "year": 2026, "month": 2, "label": "2026년 2월" },
        { "year": 2026, "month": 1, "label": "2026년 1월" }
    ]
}
```

---

## 4.3 Teacher API

### 강사 목록 조회

```
GET /api/teachers
```

#### Parameters

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| academyId | Long | X | 학원 ID로 필터 |
| subjectId | Long | X | 과목 ID로 필터 |
| isActive | Boolean | X | 활성 상태로 필터 |

#### Response

```json
[
    {
        "id": 1,
        "name": "홍길동",
        "academyName": "에듀윌",
        "subjectName": "국어",
        "aliases": ["길동쌤", "홍쌤"],
        "isActive": true
    }
]
```

---

### 강사 상세 조회

```
GET /api/teachers/{id}
```

#### Response

```json
{
    "id": 1,
    "name": "홍길동",
    "academyId": 1,
    "academyName": "에듀윌",
    "subjectId": 1,
    "subjectName": "국어",
    "aliases": ["길동쌤", "홍쌤"],
    "isActive": true,
    "createdAt": "2026-01-01T00:00:00"
}
```

---

## 4.4 Academy API

### 학원 목록 조회

```
GET /api/academies
```

#### Response

```json
[
    {
        "id": 1,
        "name": "에듀윌",
        "shortName": "eduwill",
        "websiteUrl": "https://www.eduwill.net"
    },
    {
        "id": 2,
        "name": "윌비스",
        "shortName": "willbes",
        "websiteUrl": "https://www.willbes.net"
    }
]
```

---

## 4.5 Subject API

### 과목 목록 조회

```
GET /api/subjects
```

#### Response

```json
[
    { "id": 1, "name": "국어" },
    { "id": 2, "name": "영어" },
    { "id": 3, "name": "한국사" },
    { "id": 4, "name": "행정학" },
    { "id": 5, "name": "행정법" }
]
```

---

## 4.6 Health Check

### 서비스 상태 확인

```
GET /actuator/health
```

#### Response

```json
{
    "status": "UP",
    "components": {
        "db": {
            "status": "UP",
            "details": {
                "database": "PostgreSQL",
                "validationQuery": "isValid()"
            }
        },
        "diskSpace": {
            "status": "UP"
        }
    }
}
```

---

## 4.7 에러 코드

| 코드 | HTTP Status | 설명 |
|------|-------------|------|
| BAD_REQUEST | 400 | 잘못된 요청 파라미터 |
| NOT_FOUND | 404 | 리소스를 찾을 수 없음 |
| INTERNAL_ERROR | 500 | 서버 내부 오류 |

---

[← 도메인 모델](./3.-Domain-Model) | [다음: 개발 가이드 →](./5.-Development-Guide)
