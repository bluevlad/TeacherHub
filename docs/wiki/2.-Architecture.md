# 2. 아키텍처 (Architecture)

## 2.1 시스템 개요

TeacherHub는 3-Tier 아키텍처 기반의 마이크로서비스 구조를 채택합니다.

```
┌─────────────────────────────────────────────────────────────────────┐
│                         Presentation Layer                          │
│                                                                     │
│    ┌─────────────────────────────────────────────────────────┐     │
│    │                  React Dashboard                         │     │
│    │              (localhost:3000 / :4010)                    │     │
│    └─────────────────────────────────────────────────────────┘     │
└─────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────┐
│                         Application Layer                           │
│                                                                     │
│    ┌─────────────────────────────────────────────────────────┐     │
│    │              Spring Boot Backend                         │     │
│    │              (localhost:8081 / :9010)                    │     │
│    │                                                          │     │
│    │    ┌──────────────┐    ┌──────────────┐                 │     │
│    │    │ ReportController │  │ TeacherController │            │     │
│    │    └──────────────┘    └──────────────┘                 │     │
│    └─────────────────────────────────────────────────────────┘     │
│                                                                     │
│    ┌─────────────────────────────────────────────────────────┐     │
│    │              AI Crawler (Python)                         │     │
│    │                   (Batch Job)                            │     │
│    └─────────────────────────────────────────────────────────┘     │
└─────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────┐
│                           Data Layer                                │
│                                                                     │
│    ┌─────────────────────────────────────────────────────────┐     │
│    │                    PostgreSQL 15                         │     │
│    │               (localhost:5432 / :5432)                   │     │
│    └─────────────────────────────────────────────────────────┘     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 2.2 컴포넌트 구조

### Frontend (React)

```
frontend/
└── src/
    ├── api/
    │   └── index.js           # Axios 클라이언트, API 함수
    ├── components/
    │   └── PeriodSelector.js  # 기간 선택 컴포넌트
    ├── pages/
    │   └── Dashboard.js       # 메인 대시보드
    └── App.js                 # 앱 엔트리
```

| 컴포넌트 | 역할 |
|----------|------|
| `App.js` | 테마 설정, 라우팅 |
| `Dashboard.js` | 통계 카드, 강사 랭킹 테이블 |
| `PeriodSelector.js` | 일별/주별/월별 탭, 드롭다운 |
| `api/index.js` | REST API 호출 |

### Backend (Spring Boot)

```
backend/
└── src/main/java/com/teacherhub/
    ├── controller/
    │   ├── ReportController.java    # 기간별 리포트 API
    │   └── TeacherController.java   # 강사 관리 API
    ├── dto/
    │   ├── PeriodReportDTO.java     # 기간 리포트 응답
    │   └── PeriodSummaryDTO.java    # 강사별 집계
    ├── entity/
    │   ├── Teacher.java             # 강사 엔티티
    │   ├── DailyReport.java         # 일일 리포트 엔티티
    │   └── TeacherMention.java      # 강사 언급 엔티티
    ├── repository/
    │   └── DailyReportRepository.java
    └── service/
        └── ReportService.java
```

| 레이어 | 역할 |
|--------|------|
| Controller | HTTP 요청/응답 처리 |
| DTO | 데이터 전송 객체 |
| Service | 비즈니스 로직 |
| Repository | 데이터 접근 |
| Entity | JPA 엔티티 |

### AI Crawler (Python)

```
ai-crawler/
└── src/
    ├── crawlers/
    │   └── dcinside.py        # 디시인사이드 크롤러
    ├── analyzers/
    │   └── sentiment.py       # 감성 분석
    ├── models/
    │   └── entities.py        # SQLAlchemy 모델
    └── main.py                # 엔트리포인트
```

| 모듈 | 역할 |
|------|------|
| `dcinside.py` | Playwright 기반 크롤링 |
| `sentiment.py` | TextBlob 감성 분석 |
| `entities.py` | DB 모델 정의 |

---

## 2.3 기술 스택 상세

### Backend

| 기술 | 버전 | 선택 이유 |
|------|------|----------|
| Java | 17 | LTS, Spring Boot 3.x 호환 |
| Spring Boot | 3.2 | 최신 안정 버전, 간편한 설정 |
| Spring Data JPA | - | ORM 추상화, Repository 패턴 |
| PostgreSQL | 15 | 안정성, JSON 지원, 무료 |
| Gradle | 8.x | 빌드 속도, Kotlin DSL |

### Frontend

| 기술 | 버전 | 선택 이유 |
|------|------|----------|
| React | 18 | 컴포넌트 기반, 생태계 |
| Material UI | 5 | 빠른 UI 개발, 일관성 |
| Axios | 1.x | HTTP 클라이언트, 인터셉터 |
| date-fns | 2.x | 날짜 처리, 경량화 |

### AI Crawler

| 기술 | 버전 | 선택 이유 |
|------|------|----------|
| Python | 3.10+ | 데이터 처리 생태계 |
| Playwright | 1.40+ | 모던 웹 크롤링, 안정성 |
| TextBlob | 0.18+ | 간편한 감성 분석 |
| SQLAlchemy | 2.0+ | Python ORM 표준 |
| psycopg2 | 2.9+ | PostgreSQL 드라이버 |

### Infrastructure

| 기술 | 용도 |
|------|------|
| Docker | 컨테이너화 |
| Docker Compose | 멀티 컨테이너 관리 |
| GitHub Actions | CI/CD 파이프라인 |
| OrbStack | MacBook 운영 환경 |

---

## 2.4 데이터 흐름

### 크롤링 → 분석 → 저장

```
┌──────────────┐     ┌──────────────┐     ┌──────────────┐
│   DCInside   │────▶│  AI Crawler  │────▶│  PostgreSQL  │
│  공무원갤러리  │     │              │     │              │
└──────────────┘     │  1. 크롤링    │     │  posts       │
                     │  2. 언급 탐지  │     │  mentions    │
                     │  3. 감성 분석  │     │  daily_reports│
                     │  4. 집계      │     │              │
                     └──────────────┘     └──────────────┘
```

### API 요청 → 응답

```
┌──────────────┐     ┌──────────────┐     ┌──────────────┐
│   Frontend   │────▶│   Backend    │────▶│  PostgreSQL  │
│              │     │              │     │              │
│  1. 기간 선택 │     │  1. 쿼리 생성 │     │  daily_reports│
│  2. API 호출 │     │  2. 집계 연산 │     │              │
│  3. 렌더링   │◀────│  3. DTO 변환 │◀────│              │
└──────────────┘     └──────────────┘     └──────────────┘
```

---

## 2.5 배포 구성

### 개발 환경 (Windows)

| 서비스 | 포트 |
|--------|------|
| Frontend | 3000 |
| Backend | 8081 |
| PostgreSQL | 5432 |

### 운영 환경 (MacBook OrbStack)

| 서비스 | 내부 포트 | 외부 포트 |
|--------|----------|----------|
| Frontend | 3000 | 4010 |
| Backend | 8080 | 9010 |
| PostgreSQL | 5432 | - |

### Docker 네트워크

```
┌─────────────────────────────────────────────────────────┐
│                  teacherhub-network                      │
│                                                          │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐              │
│  │ frontend │  │ backend  │  │    db    │              │
│  │  :4010   │  │  :9010   │  │  :5432   │              │
│  └──────────┘  └──────────┘  └──────────┘              │
└─────────────────────────────────────────────────────────┘
```

---

## 2.6 보안 고려사항

### 현재 구현
- Docker 네트워크 격리
- PostgreSQL 내부 네트워크만 노출
- 환경변수 기반 설정

### 향후 계획
- API 인증 (JWT)
- Rate Limiting
- HTTPS 적용

---

[← 프로젝트 개요](./1.-Project-Overview) | [다음: 도메인 모델 →](./3.-Domain-Model)
